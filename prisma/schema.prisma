generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["omitApi"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Chatroom {
  id         String   @id @default(uuid())
  name       String?
  created    DateTime @default(now()) @db.Date
  colorClass String   @map("color_class")

  participtants User[]
  messages      Message[]

  @@map("chatrooms")
}

model Message {
  id      String      @id @default(uuid())
  body    String
  created DateTime    @default(now()) @db.Date
  type    MessageType @default(ACTION)

  chatRoomId String   @unique
  chatroom   Chatroom @relation(fields: [chatRoomId], references: [id])

  userId String?
  user   User?   @relation(fields: [userId], references: [id])

  @@map("messages")
}

model User {
  id           String   @id @default(uuid())
  username     String   @unique
  email        String   @unique
  password     String
  role         UserRole @default(USER)
  created      DateTime @default(now()) @db.Date
  isOnline     Boolean  @map("is_online")
  profileImage String?  @map("profile_image")
  colorClass   String   @map("color_class")

  contacts    User[] @relation("UserContacts")
  contactedBy User[] @relation("UserContacts")

  chatrooms Chatroom[]
  messages  Message[]

  @@map("users")
}

enum MessageType {
  ACTION
  MESSAGE
}

enum UserRole {
  USER
  ADMIN
}
